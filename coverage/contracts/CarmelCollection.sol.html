<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/CarmelCollection.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> CarmelCollection.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>34/34</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>28/28</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>12/12</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>56/56</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">92×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">92×</span>
<span class="cline-any cline-yes">92×</span>
<span class="cline-any cline-yes">92×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">92×</span>
<span class="cline-any cline-yes">92×</span>
<span class="cline-any cline-yes">92×</span>
<span class="cline-any cline-yes">92×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">92×</span>
<span class="cline-any cline-yes">92×</span>
<span class="cline-any cline-yes">92×</span>
<span class="cline-any cline-yes">92×</span>
<span class="cline-any cline-yes">92×</span>
<span class="cline-any cline-yes">92×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/***********************************************************************************************************\
 *   ______     ___      .______      .___  ___.  _______  __          ______  __  .___________.____    ____ *
 *  /      |   /   \     |   _  \     |   \/   | |   ____||  |        /      ||  | |           |\   \  /   / *
 * |  ,----'  /  ^  \    |  |_)  |    |  \  /  | |  |__   |  |       |  ,----'|  | `---|  |----` \   \/   /  *
 * |  |      /  /_\  \   |      /     |  |\/|  | |   __|  |  |       |  |     |  |     |  |       \_    _/   *
 * |  `----./  _____  \  |  |\  \----.|  |  |  | |  |____ |  `----.__|  `----.|  |     |  |         |  |     *
 *  \______/__/     \__\ | _| `._____||__|  |__| |_______||_______(__)\______||__|     |__|         |__|     *
 *                                                                                                           *
 *  Copyright (C) 2025 - I. Dan Calinescu                                                                    *
 *  License: This code is licensed under MIT License (see LICENSE for details)                               *
 *                                                                                                           *
 *  CarmelCollection.sol                                                                                     *  
 *                                                                                                           *                                                                                                       *
 *  This code is part of the Carmel City platform (https://carmel.city) and open sourced at:                 *
 *  https://github.com/carmelcity                                                                            *
 *                                                                                                           * 
 \***********************************************************************************************************/                                                                                                          
&nbsp;
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.28;
&nbsp;
import "@openzeppelin/contracts-upgradeable/proxy/utils/Initializable.sol";
import "@openzeppelin/contracts-upgradeable/token/ERC721/ERC721Upgradeable.sol";
import "@openzeppelin/contracts/token/ERC20/ERC20.sol";
import "./CarmelRegistry.sol";
&nbsp;
/// @title A Carmel Asset Collection
/// @author I. Dan Calinescu
/// @notice This represents an asset collection of NFTs
/// @custom:oz-upgrades-unsafe-allow external-library-linking
contract CarmelCollection is Initializable, ERC721Upgradeable, CarmelBase {
&nbsp;
    uint8 constant internal LEVEL_BASIC = 10;
    uint8 constant internal LEVEL_HIGH = 20;
    uint8 constant internal LEVEL_ADVANCED = 30;
&nbsp;
    /// @dev
    event CarmelAssetMinted(bytes32 collectionId, address owner, uint256 tokenId);
    event CarmelAssetStateUpdated(uint8 kind, bytes32 collectionId, uint256 tokenId, uint256 rev, bytes32 key, bytes32 val);
    event CarmelAssetDataUpdated(uint256 tokenId);
&nbsp;
    /// @dev
    CarmelRegistry private _registry;
&nbsp;
    /// @dev
    // ERC20 private _token;
&nbsp;
    /// @dev Keep track of the main account that owns this collection
    bytes32 private _account;
&nbsp;
    /// @dev
    bytes32 private _collectionId;
&nbsp;
    /// @dev
    uint256 _totalTokens;
&nbsp;
    /// @dev
    mapping(uint256 =&gt; bytes32[2]) private _hashes;
&nbsp;
    /// @dev
    mapping(bytes32 =&gt; bytes32) private _config;
&nbsp;
    /// @dev
    mapping(address =&gt; uint8) private _level;
&nbsp;
    /// @dev Keep track of the main owner of this registry
    address private _owner;
&nbsp;
    /// @dev
    mapping(address =&gt; uint256[]) private _tokens;
&nbsp;
    /// @dev
    mapping(uint256 =&gt; uint256) private _revisions;
&nbsp;
    /// @custom:oz-upgrades-unsafe-allow constructor
    constructor() {
        _disableInitializers();
    }
&nbsp;
    /// @dev called only once at deployment
    function initialize(
        bytes32 user,
        address reg,
        address token,
        bytes32 collectionId,
        bytes32 defaultHash0,
        bytes32 defaultHash1,
        string memory name,
        string memory symbol,
        bytes32 supply,
        bytes32 price,
        bytes32 batch
    ) initializer public {
        _account = user;
        _owner = msg.sender;
        _collectionId = collectionId;
        // _token = ERC20(token);
        _perms[msg.sender] = ADMIN_PERM;
        _level[msg.sender] = 3;
        _registry = CarmelRegistry(reg);
        __ERC721_init(name, symbol);
&nbsp;
        _config["defaultHash0"] = defaultHash0;
        _config["defaultHash1"] = defaultHash1;
        _config["mintPrice"] = price;
        _config["maxBatch"] = batch;
        _config["maxSupply"] = supply;
        _config["whitelist"] = bytes32("0x1");
    }
&nbsp;
    /************************************************************************\
    *                     _    _               _                             *
    *   ___   ___  _ __  | |_ (_) _ __    ___ | |   __ _  _ __  ___   __ _   *
    *  / __| / _ \| '_ \ | __|| || '_ \  / _ \| |  / _` || '__|/ _ \ / _` |  *
    *  \__ \|  __/| | | || |_ | || | | ||  __/| | | (_| || |  |  __/| (_| |  *
    *  |___/ \___||_| |_| \__||_||_| |_| \___||_|  \__,_||_|   \___| \__,_|  *
    \************************************************************************/
&nbsp;
    /// @notice Update an asset's hash
    /// @dev This can only be ran by a sentinel
    function updateHash(uint256 tokenId, bytes32 h0, bytes32 h1, CarmelFingerprint calldata fingerprint) public requireSentinel {       
        if (!_registry.verify(fingerprint)) revert CarmelErrorUnauthorizedAccount();
        if(tokenId &gt;= _totalTokens) revert CarmelErrorAssetNotMinted();
&nbsp;
        _hashes[tokenId][0] = h0;
        _hashes[tokenId][1] = h1;
        _revisions[tokenId] = _revisions[tokenId] + 1;
&nbsp;
        emit CarmelAssetDataUpdated(tokenId);
    }
&nbsp;
    /// @notice Update a configuration setting
    function updateConfig(bytes32 key, bytes32 val, CarmelFingerprint calldata fingerprint) public requireSentinel {       
        if (!_registry.verify(fingerprint)) revert CarmelErrorUnauthorizedAccount();
&nbsp;
        _config[key] = val;
    }
&nbsp;
    /// @notice Update the whitelist
    function updateLevel(address addr, uint8 level, CarmelFingerprint calldata fingerprint) public requireSentinel {       
        if (!_registry.verify(fingerprint)) revert CarmelErrorUnauthorizedAccount();
&nbsp;
        _level[addr] = level;
    }
&nbsp;
    /*********************************************************************\
    *                    _      _  _                                      *
    *      _ __   _   _ | |__  | |(_)  ___    __ _  _ __  ___   __ _      *
    *     | '_ \ | | | || '_ \ | || | / __|  / _` || '__|/ _ \ / _` |     *
    *     | |_) || |_| || |_) || || || (__  | (_| || |  |  __/| (_| |     *
    *     | .__/  \__,_||_.__/ |_||_| \___|  \__,_||_|   \___| \__,_|     *
    *     |_|                                                             *
    \*********************************************************************/
&nbsp;
    /// @notice Mints one or more assets all at once
    /// @param quantity The number of assets to mint at once
    /// @dev This assumes the sender is whitelisted or the whitelist is turned off
    function safeMintBatch(uint256 quantity) public payable {
        uint256 tokenId = _totalTokens;
        bool notOnList = _level[msg.sender] &lt; LEVEL_BASIC;
        bool isPaid = _level[msg.sender] == LEVEL_BASIC;
        bool isPriviledged = _level[msg.sender] == LEVEL_ADVANCED;
        uint256 price = uint256(_config["mintPrice"]) * quantity;
&nbsp;
        if(uint256(_config["maxSupply"]) &lt;= tokenId + quantity) revert CarmelErrorAssetMintingMaxSupplyReached();
        if(_config["whitelist"] &gt; 0 &amp;&amp; notOnList) revert CarmelErrorAssetMintingUnauthorized();
        if(!isPriviledged &amp;&amp; uint256(_config["maxBatch"]) &lt; quantity + _tokens[msg.sender].length) revert CarmelErrorAssetMintingInvalidQuantity();
        if (isPaid &amp;&amp; msg.value != price) revert CarmelErrorAssetMintingInvalidPrice();
&nbsp;
        if (isPaid) {
            payable(_owner).transfer(price);
        }
&nbsp;
        for (uint256 i = 0; i &lt; quantity; i++) {
            _safeMint(msg.sender, tokenId);
            _tokens[msg.sender].push(tokenId);
            _revisions[tokenId] = 0;
            _hashes[tokenId][0] = _config["defaultHash0"];
            _hashes[tokenId][1] = _config["defaultHash1"];
            emit CarmelAssetMinted(_config["collectionId"], msg.sender, tokenId);     
            emit CarmelAssetDataUpdated(tokenId);
            _totalTokens = _totalTokens + 1;       
            tokenId = _totalTokens;
        }
    }
&nbsp;
    /// @dev
    function getConfig(bytes32 key) public view returns (bytes32) {
        return _config[key];
    }
&nbsp;
    /// @dev
    function getLevel(address addr) public view returns (uint8) {
        return _level[addr];
    }
&nbsp;
    /// @dev
    function version() public pure returns (uint256) {
        return 1;
    }
&nbsp;
    /// @dev
    function tokenURI(uint256 tokenId) public view virtual override returns (string memory) {
        if(tokenId &gt;= _totalTokens) revert CarmelErrorAssetNotMinted();
&nbsp;
        return string(abi.encodePacked("ipfs://", bytes32ToString(_hashes[tokenId][0]), bytes32ToString(_hashes[tokenId][1])));
    }
&nbsp;
    /// @dev
    function totalSupply() public view returns (uint256) {
        return _totalTokens;
    }
&nbsp;
    /*******************************************************************************\
    *      _         _                             _                                *
    *     (_) _ __  | |_  ___  _ __  _ __    __ _ | |   __ _  _ __  ___   __ _      *
    *     | || '_ \ | __|/ _ \| '__|| '_ \  / _` || |  / _` || '__|/ _ \ / _` |     *
    *     | || | | || |_|  __/| |   | | | || (_| || | | (_| || |  |  __/| (_| |     *
    *     |_||_| |_| \__|\___||_|   |_| |_| \__,_||_|  \__,_||_|   \___| \__,_|     *
    \*******************************************************************************/
&nbsp;
    function bytes32ToString(bytes32 _bytes32) public pure returns (string memory) {
        uint8 i = 0;
        while(i &lt; 32 &amp;&amp; _bytes32[i] != 0) i++;
&nbsp;
        bytes memory bytesArray = new bytes(i);
        for (i = 0; i &lt; 32 &amp;&amp; _bytes32[i] != 0; i++) bytesArray[i] = _bytes32[i];
&nbsp;
        return string(bytesArray);
    }
}</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Fri Jan 17 2025 10:43:21 GMT+0100 (Central European Standard Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
